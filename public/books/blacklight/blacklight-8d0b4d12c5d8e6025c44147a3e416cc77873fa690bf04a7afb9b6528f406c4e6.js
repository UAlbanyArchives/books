"use strict";var Blacklight=function(){var t=new Array;return{onLoad:function(e){t.push(e)},activate:function(){for(var e=0;e<t.length;e++)t[e].call()},listeners:function(){var t=[];return"undefined"!=typeof Turbo?t.push("turbo:load"):"undefined"!=typeof Turbolinks&&Turbolinks.supported?Turbolinks.BrowserAdapter?t.push("turbolinks:load"):t.push("page:load","DOMContentLoaded"):t.push("DOMContentLoaded"),t}}}();Blacklight.listeners().forEach(function(t){document.addEventListener(t,function(){Blacklight.activate()})}),Blacklight.onLoad(function(){var t=document.querySelector(".no-js");t&&(t.classList.remove("no-js"),t.classList.add("js"))}),window.Blacklight=Blacklight,Blacklight.onLoad(function(){$('[data-autocomplete-enabled="true"]').each(function(){var t=$(this);if(!t.hasClass("tt-hint")){var e=t.data().autocompletePath,a=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:e+"?q=%QUERY",wildcard:"%QUERY"}});a.initialize(),t.typeahead({hint:!0,highlight:!0,minLength:2},{name:"terms",displayKey:"term",source:a.ttAdapter()})}})}),function(t){Blacklight.doBookmarkToggleBehavior=function(){if("function"==typeof Blacklight.do_bookmark_toggle_behavior)return console.warn("do_bookmark_toggle_behavior is deprecated. Use doBookmarkToggleBehavior instead."),Blacklight.do_bookmark_toggle_behavior();t(Blacklight.doBookmarkToggleBehavior.selector).blCheckboxSubmit({cssClass:"toggle-bookmark",success:function(e,a){a.bookmarks&&t("[data-role=bookmark-counter]").text(a.bookmarks.count)}})},Blacklight.doBookmarkToggleBehavior.selector="form.bookmark-toggle",Blacklight.onLoad(function(){Blacklight.doBookmarkToggleBehavior()})}(jQuery),Blacklight.onLoad(function(){document.querySelectorAll("button.collapse-toggle").forEach(function(t){t.addEventListener("click",function(){event.target.focus()})})}),function(t){t.fn.blCheckboxSubmit=function(e){return this.each(function(){function a(t){i.prop("checked",t),c.toggleClass("checked",t),t?(l.find("input[name=_method]").val("delete"),d.html(l.attr("data-present"))):(l.find("input[name=_method]").val("put"),d.html(l.attr("data-absent")))}var o=t.extend({},t.fn.blCheckboxSubmit.defaults,e),l=t(this);l.children().hide(),l.find("input[type=submit]").remove();var r=l.attr("data-doc-id")||Math.random(),n=0!=l.find("input[name=_method][value=delete]").length,i=t('<input type="checkbox">').addClass(o.cssClass).attr("id",o.cssClass+"_"+r),c=t("<label>").addClass(o.cssClass).attr("for",o.cssClass+"_"+r).attr("title",l.attr("title")||""),d=t("<span>");c.append(i),c.append(" "),c.append(d);var s=t('<div class="checkbox" />').addClass(o.cssClass).append(c);l.append(s),a(n),i.click(function(){return d.html(l.attr("data-inprogress")),c.attr("disabled","disabled"),i.attr("disabled","disabled"),t.ajax({url:l.attr("action"),dataType:"json",type:l.attr("method").toUpperCase(),data:l.serialize(),error:function(){c.removeAttr("disabled"),i.removeAttr("disabled"),o.error.call()},success:function(t,e,r){0!=r.status?(a(n=!n),c.removeAttr("disabled"),i.removeAttr("disabled"),o.success.call(l,n,r.responseJSON)):(c.removeAttr("disabled"),i.removeAttr("disabled"),o.error.call())}}),!1})}),this},t.fn.blCheckboxSubmit.defaults={cssClass:"blCheckboxSubmit",error:function(){alert("Error")},success:function(){}}}(jQuery),Blacklight.doResizeFacetLabelsAndCounts=function(){function t(t,e){return e.textContent.length-t.textContent.length}document.querySelectorAll(".facet-values, .pivot-facet").forEach(function(e){var a=e.querySelectorAll(".facet-count"),o=Array.from(a).sort(t)[0];if(o&&o.textContent){var l=o.textContent.length+1+"ch";e.querySelector(".facet-count").style.width=l}})},Blacklight.onLoad(function(){Blacklight.doResizeFacetLabelsAndCounts()}),Blacklight.modal===undefined&&(Blacklight.modal={}),Blacklight.modal.modalSelector="#blacklight-modal",Blacklight.modal.triggerLinkSelector="a[data-blacklight-modal~=trigger]",Blacklight.modal.triggerFormSelector="form[data-blacklight-modal~=trigger]",Blacklight.modal.preserveLinkSelector=Blacklight.modal.modalSelector+" a[data-blacklight-modal~=preserve]",Blacklight.modal.containerSelector="[data-blacklight-modal~=container]",Blacklight.modal.modalCloseSelector="[data-blacklight-modal~=close]",Blacklight.modal.onFailure=function(t,e,a){console.error("Server error:",this.url,t.status,a);var o='<div class="modal-header"><div class="modal-title">There was a problem with your request.</div><button type="button" class="blacklight-modal-close btn-close close" data-dismiss="modal" aria-label="Close">  <span aria-hidden="true">&times;</span></button></div> <div class="modal-body"><p>Expected a successful response from the server, but got an error</p><pre>'+this.type+" "+this.url+"\n"+t.status+": "+a+"</pre></div>";$(Blacklight.modal.modalSelector).find(".modal-content").html(o),Blacklight.modal.show()},Blacklight.modal.receiveAjax=function(t){var e=$("<div>").append(jQuery.parseHTML(t)).find(Blacklight.modal.containerSelector).first();0!==e.length&&(t=e.html()),$(Blacklight.modal.modalSelector).find(".modal-content").html(t);var a=$.Event("loaded.blacklight.blacklight-modal");$(Blacklight.modal.modalSelector).trigger(a),a.isDefaultPrevented()||Blacklight.modal.show()},Blacklight.modal.modalAjaxLinkClick=function(t){t.preventDefault(),$.ajax({url:$(this).attr("href")}).fail(Blacklight.modal.onFailure).done(Blacklight.modal.receiveAjax)},Blacklight.modal.modalAjaxFormSubmit=function(t){t.preventDefault(),$.ajax({url:$(this).attr("action"),data:$(this).serialize(),type:$(this).attr("method")}).fail(Blacklight.modal.onFailure).done(Blacklight.modal.receiveAjax)},Blacklight.modal.setupModal=function(){var t=$.Event("setup.blacklight.blacklight-modal");$("body").trigger(t),t.isDefaultPrevented()||($("body").on("click",Blacklight.modal.triggerLinkSelector+", "+Blacklight.modal.preserveLinkSelector,Blacklight.modal.modalAjaxLinkClick),$("body").on("submit",Blacklight.modal.triggerFormSelector+", "+Blacklight.modal.preserveFormSelector,Blacklight.modal.modalAjaxFormSubmit),$("body").on("loaded.blacklight.blacklight-modal",Blacklight.modal.checkCloseModal),$("body").on("click",Blacklight.modal.modalSelector+" a[data-dismiss~=modal]",function(t){t.preventDefault()}))},Blacklight.modal.checkCloseModal=function(t){if($(t.target).find(Blacklight.modal.modalCloseSelector).length){var e=$(this).find(".flash_messages");Blacklight.modal.hide(t.target),t.preventDefault(),$("#main-flashes").append(e),e.fadeIn(500)}},Blacklight.modal.hide=function(t){"undefined"!=typeof bootstrap&&"undefined"!=typeof bootstrap.Modal&&bootstrap.Modal.VERSION>="5"?bootstrap.Modal.getOrCreateInstance(t||document.querySelector(Blacklight.modal.modalSelector)).hide():$(t||Blacklight.modal.modalSelector).modal("hide")},Blacklight.modal.show=function(t){"undefined"!=typeof bootstrap&&"undefined"!=typeof bootstrap.Modal&&bootstrap.Modal.VERSION>="5"?bootstrap.Modal.getOrCreateInstance(t||document.querySelector(Blacklight.modal.modalSelector)).show():$(t||Blacklight.modal.modalSelector).modal("show")},Blacklight.onLoad(function(){Blacklight.modal.setupModal()}),Blacklight.doSearchContextBehavior=function(){if("function"==typeof Blacklight.do_search_context_behavior)return console.warn("do_search_context_behavior is deprecated. Use doSearchContextBehavior instead."),Blacklight.do_search_context_behavior();var t=document.querySelectorAll("a[data-context-href]");Array.prototype.slice.call(t).forEach(function(t){t.addEventListener("click",function(t){Blacklight.handleSearchContextMethod.call(t.currentTarget,t)})})},Blacklight.csrfToken=function(){var t;return null===(t=document.querySelector("meta[name=csrf-token]"))||void 0===t?void 0:t.content},Blacklight.csrfParam=function(){var t;return null===(t=document.querySelector("meta[name=csrf-param]"))||void 0===t?void 0:t.content},Blacklight.handleSearchContextMethod=function(t){if("function"==typeof Blacklight.handle_search_context_method)return console.warn("handle_search_context_method is deprecated. Use handleSearchContextMethod instead."),Blacklight.handle_search_context_method(t);var e=this,a=e.getAttribute("data-context-href"),o=e.getAttribute("target"),l=Blacklight.csrfToken(),r=Blacklight.csrfParam(),n=document.createElement("form");n.method="post",n.action=a;var i='<input name="_method" value="post" type="hidden" />\n    <input name="redirect" value="'.concat(e.getAttribute("href"),'" type="hidden" />');(t.metaKey||t.ctrlKey)&&(o="_blank"),r!==undefined&&l!==undefined&&(i+='<input name="'.concat(r,'" value="').concat(l,'" type="hidden" />')),i+='<input type="submit" />',o&&n.setAttribute("target",o),n.style.display="none",n.innerHTML=i,document.body.appendChild(n),n.querySelector('[type="submit"]').click(),t.preventDefault(),t.stopPropagation()},Blacklight.onLoad(function(){Blacklight.doSearchContextBehavior()});